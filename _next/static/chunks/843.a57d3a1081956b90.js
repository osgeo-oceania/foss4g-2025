(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[843],{27:(e,t,r)=>{"use strict";r.d(t,{z0:()=>Z,T3:()=>j,tG:()=>I,Wd:()=>H,ov:()=>B,kL:()=>F,Ay:()=>$});var n=r(4232);let o=n.createContext(null);function i(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1;return!0}if(Array.isArray(t))return!1;if("object"==typeof e&&"object"==typeof t){let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let n of r)if(!t.hasOwnProperty(n)||!i(e[n],t[n]))return!1;return!0}return!1}function a(e,t){if(!e.getProjection)return;let r=e.getProjection();i(r,t.getProjection())||t.setProjection(r)}function s(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function l(e,t){let r=t.viewState||t,n=!1;if("zoom"in r){let t=e.zoom;e.zoom=r.zoom,n=n||t!==e.zoom}if("bearing"in r){let t=e.bearing;e.bearing=r.bearing,n=n||t!==e.bearing}if("pitch"in r){let t=e.pitch;e.pitch=r.pitch,n=n||t!==e.pitch}if(r.padding&&!e.isPaddingEqual(r.padding)&&(n=!0,e.padding=r.padding),"longitude"in r&&"latitude"in r){let t=e.center;e.center=new t.constructor(r.longitude,r.latitude),n=n||t!==e.center}return n}let u=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function c(e){if(!e)return null;if("string"==typeof e||("toJS"in e&&(e=e.toJS()),!e.layers))return e;let t={};for(let r of e.layers)t[r.id]=r;let r=e.layers.map(e=>{let r=null;"interactive"in e&&(r=Object.assign({},e),delete r.interactive);let n=t[e.ref];if(n)for(let t of(r=r||Object.assign({},e),delete r.ref,u))t in n&&(r[t]=n[t]);return r||e});return{...e,layers:r}}var d=r(5364);let f={version:8,sources:{},layers:[]},h={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},p={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},m={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},g=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],y=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class v{constructor(e,t,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=e=>{let t=this.props[m[e.type]];t?t(e):"error"===e.type&&console.error(e.error)},this._onPointerEvent=e=>{("mousemove"===e.type||"mouseout"===e.type)&&this._updateHover(e);let t=this.props[h[e.type]];t&&(this.props.interactiveLayerIds&&"mouseover"!==e.type&&"mouseout"!==e.type&&(e.features=this._hoveredFeatures||this._queryRenderedFeatures(e.point)),t(e),delete e.features)},this._onCameraEvent=e=>{if(!this._internalUpdate){let t=this.props[p[e.type]];t&&t(e)}e.type in this._deferredEvents&&(this._deferredEvents[e.type]=!1)},this._MapClass=e,this.props=t,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){let t=this.props;this.props=e;let r=this._updateSettings(e,t);r&&this._createShadowTransform(this._map);let n=this._updateSize(e),o=this._updateViewState(e,!0);this._updateStyle(e,t),this._updateStyleComponents(e,t),this._updateHandlers(e,t),(r||n||o&&!this._map.isMoving())&&this.redraw()}static reuse(e,t){let r=v.savedMaps.pop();if(!r)return null;let n=r.map,o=n.getContainer();for(t.className=o.className;o.childNodes.length>0;)t.appendChild(o.childNodes[0]);n._container=t;let i=n._resizeObserver;i&&(i.disconnect(),i.observe(t)),r.setProps({...e,styleDiffing:!1}),n.resize();let{initialViewState:a}=e;return a&&(a.bounds?n.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),n.isStyleLoaded()?n.fire("load"):n.once("styledata",()=>n.fire("load")),n._update(),r}_initialize(e){let{props:t}=this,{mapStyle:r=f}=t,n={...t,...t.initialViewState,accessToken:t.mapboxAccessToken||function(){let e=null;if("undefined"!=typeof location){let t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||d.env.MapboxAccessToken}catch(e){}try{e=e||d.env.REACT_APP_MAPBOX_ACCESS_TOKEN}catch(e){}return e}()||null,container:e,style:c(r)},o=n.initialViewState||n.viewState||n;if(Object.assign(n,{center:[o.longitude||0,o.latitude||0],zoom:o.zoom||0,pitch:o.pitch||0,bearing:o.bearing||0}),t.gl){let e=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=e,t.gl)}let i=new this._MapClass(n);o.padding&&i.setPadding(o.padding),t.cursor&&(i.getCanvas().style.cursor=t.cursor),this._createShadowTransform(i);let s=i._render;i._render=e=>{this._inRender=!0,s.call(i,e),this._inRender=!1};let l=i._renderTaskQueue.run;i._renderTaskQueue.run=e=>{l.call(i._renderTaskQueue,e),this._onBeforeRepaint()},i.on("render",()=>this._onAfterRepaint());let u=i.fire;for(let e in i.fire=this._fireEvent.bind(this,u),i.on("resize",()=>{this._renderTransform.resize(i.transform.width,i.transform.height)}),i.on("styledata",()=>{this._updateStyleComponents(this.props,{}),a(i.transform,this._renderTransform)}),i.on("sourcedata",()=>this._updateStyleComponents(this.props,{})),h)i.on(e,this._onPointerEvent);for(let e in p)i.on(e,this._onCameraEvent);for(let e in m)i.on(e,this._onEvent);this._map=i}recycle(){let e=this.map.getContainer().querySelector("[mapboxgl-children]");null==e||e.remove(),v.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){let e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){let t=function(e){let t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}(e.transform);e.painter.transform=t,this._renderTransform=t}_updateSize(e){let{viewState:t}=e;if(t){let e=this._map;if(t.width!==e.transform.width||t.height!==e.transform.height)return e.resize(),!0}return!1}_updateViewState(e,t){if(this._internalUpdate)return!1;let r=this._map,n=this._renderTransform,{zoom:o,pitch:i,bearing:a}=n,u=r.isMoving();u&&(n.cameraElevationReference="sea");let c=l(n,{...s(r.transform),...e});if(u&&(n.cameraElevationReference="ground"),c&&t){let e=this._deferredEvents;e.move=!0,e.zoom||(e.zoom=o!==n.zoom),e.rotate||(e.rotate=a!==n.bearing),e.pitch||(e.pitch=i!==n.pitch)}return u||l(r.transform,e),c}_updateSettings(e,t){let r=this._map,n=!1;for(let o of g)if(o in e&&!i(e[o],t[o])){n=!0;let t=r[`set${o[0].toUpperCase()}${o.slice(1)}`];null==t||t.call(r,e[o])}return n}_updateStyle(e,t){if(e.cursor!==t.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==t.mapStyle){let{mapStyle:t=f,styleDiffing:r=!0}=e,n={diff:r};return"localIdeographFontFamily"in e&&(n.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(c(t),n),!0}return!1}_updateStyleComponents(e,t){let r=this._map,n=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!i(e.light,t.light)&&(n=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!i(e.fog,t.fog)&&(n=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!i(e.terrain,t.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(n=!0,r.setTerrain(e.terrain))),n}_updateHandlers(e,t){var r,n;let o=this._map,a=!1;for(let s of y){let l=null===(r=e[s])||void 0===r||r;i(l,null===(n=t[s])||void 0===n||n)||(a=!0,l?o[s].enable(l):o[s].disable())}return a}_queryRenderedFeatures(e){let t=this._map,r=t.transform,{interactiveLayerIds:n=[]}=this.props;try{return t.transform=this._renderTransform,t.queryRenderedFeatures(e,{layers:n.filter(t.getLayer.bind(t))})}catch(e){return[]}finally{t.transform=r}}_updateHover(e){var t;let{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){let r=e.type,n=(null===(t=this._hoveredFeatures)||void 0===t?void 0:t.length)>0,o=this._queryRenderedFeatures(e.point),i=o.length>0;!i&&n&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=o,i&&!n&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=r}else this._hoveredFeatures=null}_fireEvent(e,t,r){let n=this._map,o=n.transform,i="string"==typeof t?t:t.type;return("move"===i&&this._updateViewState(this.props,!1),i in p&&("object"==typeof t&&(t.viewState=s(o)),this._map.isMoving()))?(n.transform=this._renderTransform,e.call(n,t,r),n.transform=o):e.call(n,t,r),n}_onBeforeRepaint(){let e=this._map;for(let t in this._internalUpdate=!0,this._deferredEvents)this._deferredEvents[t]&&e.fire(t);this._internalUpdate=!1;let t=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{a(this._renderTransform,t),e.transform=t}}}v.savedMaps=[];let w=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"],x="undefined"!=typeof document?n.useLayoutEffect:n.useEffect,b=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"],_=n.createContext(null);var E=r(8477);let L=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function C(e,t){if(!e||!t)return;let r=e.style;for(let e in t){let n=t[e];Number.isFinite(n)&&!L.test(e)?r[e]=`${n}px`:r[e]=n}}function M(e){return new Set(e?e.trim().split(/\s+/):[])}(0,n.memo)((0,n.forwardRef)(function(e,t){let{map:r,mapLib:o}=(0,n.useContext)(_),i=(0,n.useRef)({props:e});i.current.props=e;let a=(0,n.useMemo)(()=>{let t=!1;n.Children.forEach(e.children,e=>{e&&(t=!0)});let r={...e,element:t?document.createElement("div"):null},s=new o.Marker(r);return s.setLngLat([e.longitude,e.latitude]),s.getElement().addEventListener("click",e=>{var t,r;null===(r=(t=i.current.props).onClick)||void 0===r||r.call(t,{type:"click",target:s,originalEvent:e})}),s.on("dragstart",e=>{var t,r;e.lngLat=a.getLngLat(),null===(r=(t=i.current.props).onDragStart)||void 0===r||r.call(t,e)}),s.on("drag",e=>{var t,r;e.lngLat=a.getLngLat(),null===(r=(t=i.current.props).onDrag)||void 0===r||r.call(t,e)}),s.on("dragend",e=>{var t,r;e.lngLat=a.getLngLat(),null===(r=(t=i.current.props).onDragEnd)||void 0===r||r.call(t,e)}),s},[]);(0,n.useEffect)(()=>(a.addTo(r.getMap()),()=>{a.remove()}),[]);let{longitude:s,latitude:l,offset:u,style:c,draggable:d=!1,popup:f=null,rotation:h=0,rotationAlignment:p="auto",pitchAlignment:m="auto"}=e;return(0,n.useEffect)(()=>{C(a.getElement(),c)},[c]),(0,n.useImperativeHandle)(t,()=>a,[]),(a.getLngLat().lng!==s||a.getLngLat().lat!==l)&&a.setLngLat([s,l]),u&&!function(e,t){let r=Array.isArray(e)?e[0]:e?e.x:0,n=Array.isArray(e)?e[1]:e?e.y:0,o=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0;return r===o&&n===i}(a.getOffset(),u)&&a.setOffset(u),a.isDraggable()!==d&&a.setDraggable(d),a.getRotation()!==h&&a.setRotation(h),a.getRotationAlignment()!==p&&a.setRotationAlignment(p),a.getPitchAlignment()!==m&&a.setPitchAlignment(m),a.getPopup()!==f&&a.setPopup(f),(0,E.createPortal)(e.children,a.getElement())})),(0,n.memo)((0,n.forwardRef)(function(e,t){let{map:r,mapLib:o}=(0,n.useContext)(_),a=(0,n.useMemo)(()=>document.createElement("div"),[]),s=(0,n.useRef)({props:e});s.current.props=e;let l=(0,n.useMemo)(()=>{let t={...e},r=new o.Popup(t);return r.setLngLat([e.longitude,e.latitude]),r.once("open",e=>{var t,r;null===(r=(t=s.current.props).onOpen)||void 0===r||r.call(t,e)}),r},[]);if((0,n.useEffect)(()=>{let e=e=>{var t,r;null===(r=(t=s.current.props).onClose)||void 0===r||r.call(t,e)};return l.on("close",e),l.setDOMContent(a).addTo(r.getMap()),()=>{l.off("close",e),l.isOpen()&&l.remove()}},[]),(0,n.useEffect)(()=>{C(l.getElement(),e.style)},[e.style]),(0,n.useImperativeHandle)(t,()=>l,[]),l.isOpen()&&((l.getLngLat().lng!==e.longitude||l.getLngLat().lat!==e.latitude)&&l.setLngLat([e.longitude,e.latitude]),e.offset&&!i(l.options.offset,e.offset)&&l.setOffset(e.offset),(l.options.anchor!==e.anchor||l.options.maxWidth!==e.maxWidth)&&(l.options.anchor=e.anchor,l.setMaxWidth(e.maxWidth)),l.options.className!==e.className)){let t=M(l.options.className),r=M(e.className);for(let e of t)r.has(e)||l.removeClassName(e);for(let e of r)t.has(e)||l.addClassName(e);l.options.className=e.className}return(0,E.createPortal)(e.children,a)}));let T=function(e,t,r,o){let i=(0,n.useContext)(_),a=(0,n.useMemo)(()=>e(i),[]);return(0,n.useEffect)(()=>{let e=o||r||t,n="function"==typeof t&&"function"==typeof r?t:null,s="function"==typeof r?r:"function"==typeof t?t:null,{map:l}=i;return!l.hasControl(a)&&(l.addControl(a,null==e?void 0:e.position),n&&n(i)),()=>{s&&s(i),l.hasControl(a)&&l.removeControl(a)}},[]),a},S=(0,n.memo)(function(e){let t=T(({mapLib:t})=>new t.AttributionControl(e),{position:e.position});return(0,n.useEffect)(()=>{C(t._container,e.style)},[e.style]),null}),P=(0,n.memo)(function(e){let t=T(({mapLib:t})=>new t.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return(0,n.useEffect)(()=>{C(t._controlContainer,e.style)},[e.style]),null}),U=(0,n.memo)((0,n.forwardRef)(function(e,t){let r=(0,n.useRef)({props:e}),o=T(({mapLib:t})=>{let n=new t.GeolocateControl(e),o=n._setupUI;return n._setupUI=e=>{n._container.hasChildNodes()||o(e)},n.on("geolocate",e=>{var t,n;null===(n=(t=r.current.props).onGeolocate)||void 0===n||n.call(t,e)}),n.on("error",e=>{var t,n;null===(n=(t=r.current.props).onError)||void 0===n||n.call(t,e)}),n.on("outofmaxbounds",e=>{var t,n;null===(n=(t=r.current.props).onOutOfMaxBounds)||void 0===n||n.call(t,e)}),n.on("trackuserlocationstart",e=>{var t,n;null===(n=(t=r.current.props).onTrackUserLocationStart)||void 0===n||n.call(t,e)}),n.on("trackuserlocationend",e=>{var t,n;null===(n=(t=r.current.props).onTrackUserLocationEnd)||void 0===n||n.call(t,e)}),n},{position:e.position});return r.current.props=e,(0,n.useImperativeHandle)(t,()=>o,[]),(0,n.useEffect)(()=>{C(o._container,e.style)},[e.style]),null})),z=(0,n.memo)(function(e){let t=T(({mapLib:t})=>new t.NavigationControl(e),{position:e.position});return(0,n.useEffect)(()=>{C(t._container,e.style)},[e.style]),null});function D(e,t){if(!e)throw Error(t)}(0,n.memo)(function(e){let t=T(({mapLib:t})=>new t.ScaleControl(e),{position:e.position}),r=(0,n.useRef)(e),o=r.current;r.current=e;let{style:i}=e;return void 0!==e.maxWidth&&e.maxWidth!==o.maxWidth&&(t.options.maxWidth=e.maxWidth),void 0!==e.unit&&e.unit!==o.unit&&t.setUnit(e.unit),(0,n.useEffect)(()=>{C(t._container,i)},[i]),null});let A=0,R=0,O=Promise.resolve().then(r.t.bind(r,1198,23)),k=n.forwardRef(function(e,t){return function(e,t,r){let i=(0,n.useContext)(o),[a,s]=(0,n.useState)(null),l=(0,n.useRef)(),{current:u}=(0,n.useRef)({mapLib:null,map:null});(0,n.useEffect)(()=>{let t;let n=e.mapLib,o=!0;return Promise.resolve(n||r).then(r=>{if(!o)return;if(!r)throw Error("Invalid mapLib");let n="Map"in r?r:r.default;if(!n.Map)throw Error("Invalid mapLib");if(function(e,t){for(let r of b)r in t&&(e[r]=t[r]);let{RTLTextPlugin:r="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;r&&e.getRTLTextPluginStatus&&"unavailable"===e.getRTLTextPluginStatus()&&e.setRTLTextPlugin(r,e=>{e&&console.error(e)},!0)}(n,e),!n.supported||n.supported(e))e.reuseMaps&&(t=v.reuse(e,l.current)),t||(t=new v(n.Map,e,l.current)),u.map=function(e){if(!e)return null;let t=e.map,r={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:r=>{let n=t.transform;t.transform=e.transform;let o=t.project(r);return t.transform=n,o},unproject:r=>{let n=t.transform;t.transform=e.transform;let o=t.unproject(r);return t.transform=n,o},queryTerrainElevation:(r,n)=>{let o=t.transform;t.transform=e.transform;let i=t.queryTerrainElevation(r,n);return t.transform=o,i},queryRenderedFeatures:(r,n)=>{let o=t.transform;t.transform=e.transform;let i=t.queryRenderedFeatures(r,n);return t.transform=o,i}};for(let e of function(e){let t=new Set,r=e;for(;r;){for(let n of Object.getOwnPropertyNames(r))"_"!==n[0]&&"function"==typeof e[n]&&"fire"!==n&&"setEventedParent"!==n&&t.add(n);r=Object.getPrototypeOf(r)}return Array.from(t)}(t))e in r||w.includes(e)||(r[e]=t[e].bind(t));return r}(t),u.mapLib=n,s(t),null==i||i.onMapMount(u.map,e.id);else throw Error("Map is not supported by this browser")}).catch(t=>{let{onError:r}=e;r?r({type:"error",target:null,originalEvent:null,error:t}):console.error(t)}),()=>{o=!1,t&&(null==i||i.onMapUnmount(e.id),e.reuseMaps?t.recycle():t.destroy())}},[]),x(()=>{a&&a.setProps(e)}),(0,n.useImperativeHandle)(t,()=>u.map,[a]);let c=(0,n.useMemo)(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]);return n.createElement("div",{id:e.id,ref:l,style:c},a&&n.createElement(_.Provider,{value:u},n.createElement("div",{"mapboxgl-children":"",style:{height:"100%"}},e.children)))}(e,t,O)}),Z=S,j=P,B=z,I=U,H=function(e){let t=(0,n.useContext)(_).map.getMap(),r=(0,n.useRef)(e),[,o]=(0,n.useState)(0),a=(0,n.useMemo)(()=>e.id||`jsx-layer-${A++}`,[]);if((0,n.useEffect)(()=>{if(t){let e=()=>o(e=>e+1);return t.on("styledata",e),e(),()=>{t.off("styledata",e),t.style&&t.style._loaded&&t.getLayer(a)&&t.removeLayer(a)}}},[t]),t&&t.style&&t.getLayer(a))try{!function(e,t,r,n){if(D(r.id===n.id,"layer id changed"),D(r.type===n.type,"layer type changed"),"custom"===r.type||"custom"===n.type)return;let{layout:o={},paint:a={},filter:s,minzoom:l,maxzoom:u,beforeId:c}=r;if(c!==n.beforeId&&e.moveLayer(t,c),o!==n.layout){let r=n.layout||{};for(let n in o)i(o[n],r[n])||e.setLayoutProperty(t,n,o[n]);for(let n in r)o.hasOwnProperty(n)||e.setLayoutProperty(t,n,void 0)}if(a!==n.paint){let r=n.paint||{};for(let n in a)i(a[n],r[n])||e.setPaintProperty(t,n,a[n]);for(let n in r)a.hasOwnProperty(n)||e.setPaintProperty(t,n,void 0)}i(s,n.filter)||e.setFilter(t,s),(l!==n.minzoom||u!==n.maxzoom)&&e.setLayerZoomRange(t,l,u)}(t,a,e,r.current)}catch(e){console.warn(e)}else!function(e,t,r){if(e.style&&e.style._loaded&&(!("source"in r)||e.getSource(r.source))){let n={...r,id:t};delete n.beforeId,e.addLayer(n,r.beforeId)}}(t,a,e);return r.current=e,null},F=function(e){let t=(0,n.useContext)(_).map.getMap(),r=(0,n.useRef)(e),[,o]=(0,n.useState)(0),a=(0,n.useMemo)(()=>e.id||`jsx-source-${R++}`,[]);(0,n.useEffect)(()=>{if(t){let e=()=>setTimeout(()=>o(e=>e+1),0);return t.on("styledata",e),e(),()=>{var r;if(t.off("styledata",e),t.style&&t.style._loaded&&t.getSource(a)){let e=null===(r=t.getStyle())||void 0===r?void 0:r.layers;if(e)for(let r of e)r.source===a&&t.removeLayer(r.id);t.removeSource(a)}}}},[t]);let s=t&&t.style&&t.getSource(a);return s?function(e,t,r){D(t.id===r.id,"source id changed"),D(t.type===r.type,"source type changed");let n="",o=0;for(let e in t)"children"!==e&&"id"!==e&&!i(r[e],t[e])&&(n=e,o++);if(!o)return;let a=t.type;"geojson"===a?e.setData(t.data):"image"===a?e.updateImage({url:t.url,coordinates:t.coordinates}):"setCoordinates"in e&&1===o&&"coordinates"===n?e.setCoordinates(t.coordinates):"setUrl"in e&&"url"===n?e.setUrl(t.url):"setTiles"in e&&"tiles"===n?e.setTiles(t.tiles):console.warn(`Unable to update <Source> prop: ${n}`)}(s,e,r.current):s=function(e,t,r){if(e.style&&e.style._loaded){let n={...r};return delete n.id,delete n.children,e.addSource(t,n),e.getSource(t)}return null}(t,a,e),r.current=e,s&&n.Children.map(e.children,e=>e&&(0,n.cloneElement)(e,{source:a}))||null},$=k},1280:(e,t,r)=>{"use strict";r.d(t,{Zs:()=>X});var n,o,i=Math.pow,a=(e,t,r)=>new Promise((n,o)=>{var i=e=>{try{s(r.next(e))}catch(e){o(e)}},a=e=>{try{s(r.throw(e))}catch(e){o(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(i,a);s((r=r.apply(e,t)).next())}),s=Uint8Array,l=Uint16Array,u=Int32Array,c=new s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),d=new s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),f=new s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=function(e,t){for(var r=new l(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var o=new u(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)o[i]=i-r[n]<<5|n;return{b:r,r:o}},p=h(c,2),m=p.b,g=p.r;m[28]=258,g[258]=28;var y=h(d,0),v=y.b;y.r;var w=new l(32768);for(o=0;o<32768;++o)n=(61680&(n=(52428&(n=(43690&o)>>1|(21845&o)<<1))>>2|(13107&n)<<2))>>4|(3855&n)<<4,w[o]=((65280&n)>>8|(255&n)<<8)>>1;var x=function(e,t,r){for(var n,o=e.length,i=0,a=new l(t);i<o;++i)e[i]&&++a[e[i]-1];var s=new l(t);for(i=1;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;if(r){n=new l(1<<t);var u=15-t;for(i=0;i<o;++i)if(e[i])for(var c=i<<4|e[i],d=t-e[i],f=s[e[i]-1]++<<d,h=f|(1<<d)-1;f<=h;++f)n[w[f]>>u]=c}else for(i=0,n=new l(o);i<o;++i)e[i]&&(n[i]=w[s[e[i]-1]++]>>15-e[i]);return n},b=new s(288);for(o=0;o<144;++o)b[o]=8;for(o=144;o<256;++o)b[o]=9;for(o=256;o<280;++o)b[o]=7;for(o=280;o<288;++o)b[o]=8;var _=new s(32);for(o=0;o<32;++o)_[o]=5;var E=x(b,9,1),L=x(_,5,1),C=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},M=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},T=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},S=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new s(r-t);return n.set(e.subarray(t,r)),n},P=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],U=function(e,t,r){var n=Error(t||P[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,U),!r)throw n;return n},z=function(e,t,r,n){var o=e.length,i=n?n.length:0;if(!o||t.f&&!t.l)return r||new s(0);var a=!r||2!=t.i,l=t.i;r||(r=new s(3*o));var u=function(e){var t=r.length;if(e>t){var n=new s(Math.max(2*t,e));n.set(r),r=n}},h=t.f||0,p=t.p||0,g=t.b||0,y=t.l,w=t.d,b=t.m,_=t.n,P=8*o;do{if(!y){h=M(e,p,1);var z=M(e,p+1,3);if(p+=3,z){if(1==z)y=E,w=L,b=9,_=5;else if(2==z){var D=M(e,p,31)+257,A=M(e,p+10,15)+4,R=D+M(e,p+5,31)+1;p+=14;for(var O=new s(R),k=new s(19),Z=0;Z<A;++Z)k[f[Z]]=M(e,p+3*Z,7);p+=3*A;for(var j=C(k),B=(1<<j)-1,I=x(k,j,1),Z=0;Z<R;){var H=I[M(e,p,B)];p+=15&H;var F=H>>4;if(F<16)O[Z++]=F;else{var $=0,N=0;for(16==F?(N=3+M(e,p,3),p+=2,$=O[Z-1]):17==F?(N=3+M(e,p,7),p+=3):18==F&&(N=11+M(e,p,127),p+=7);N--;)O[Z++]=$}}var W=O.subarray(0,D),V=O.subarray(D);b=C(W),_=C(V),y=x(W,b,1),w=x(V,_,1)}else U(1)}else{var F=((p+7)/8|0)+4,q=e[F-4]|e[F-3]<<8,K=F+q;if(K>o){l&&U(0);break}a&&u(g+q),r.set(e.subarray(F,K),g),t.b=g+=q,t.p=p=8*K,t.f=h;continue}if(p>P){l&&U(0);break}}a&&u(g+131072);for(var J=(1<<b)-1,G=(1<<_)-1,Q=p;;Q=p){var $=y[T(e,p)&J],X=$>>4;if((p+=15&$)>P){l&&U(0);break}if($||U(2),X<256)r[g++]=X;else if(256==X){Q=p,y=null;break}else{var Y=X-254;if(X>264){var Z=X-257,ee=c[Z];Y=M(e,p,(1<<ee)-1)+m[Z],p+=ee}var et=w[T(e,p)&G],er=et>>4;et||U(3),p+=15&et;var V=v[er];if(er>3){var ee=d[er];V+=T(e,p)&(1<<ee)-1,p+=ee}if(p>P){l&&U(0);break}a&&u(g+131072);var en=g+Y;if(g<V){var eo=i-V,ei=Math.min(V,en);for(eo+g<0&&U(3);g<ei;++g)r[g]=n[eo+g]}for(;g<en;g+=4)r[g]=r[g-V],r[g+1]=r[g+1-V],r[g+2]=r[g+2-V],r[g+3]=r[g+3-V];g=en}}t.l=y,t.p=Q,t.b=g,t.f=h,y&&(h=1,t.m=b,t.d=w,t.n=_)}while(!h);return g==r.length?r:S(r,0,g)},D=new s(0),A=function(e){(31!=e[0]||139!=e[1]||8!=e[2])&&U(6,"invalid gzip data");var t=e[3],r=10;4&t&&(r+=(e[10]|e[11]<<8)+2);for(var n=(t>>3&1)+(t>>4&1);n>0;n-=!e[r++]);return r+(2&t)},R=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0};function O(e,t){var r,n;return 31==e[0]&&139==e[1]&&8==e[2]?((r=A(e))+8>e.length&&U(6,"invalid gzip data"),z(e.subarray(r,-8),{i:2},t&&t.out||new s(R(e)),t&&t.dictionary)):(15&e[0])!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?z(e,{i:2},t&&t.out,t&&t.dictionary):z(e.subarray((n=t&&t.dictionary,((15&e[0])!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&U(6,"invalid zlib data"),(e[1]>>5&1)==+!n&&U(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2),-4),{i:2},t&&t.out,t&&t.dictionary)}var k="undefined"!=typeof TextDecoder&&new TextDecoder;try{k.decode(D,{stream:!0})}catch(e){}var Z=(e,t)=>e*i(2,t),j=(e,t)=>Math.floor(e/i(2,t)),B=(e,t)=>Z(e.getUint16(t+1,!0),8)+e.getUint8(t),I=(e,t)=>Z(e.getUint32(t+2,!0),16)+e.getUint16(t,!0),H=(e,t,r,n,o)=>{if(e!==n.getUint8(o))return e-n.getUint8(o);let i=B(n,o+1);if(t!==i)return t-i;let a=B(n,o+4);return r!==a?r-a:0},F=(e,t,r,n)=>{let o=N(e,128|t,r,n);return o?{z:t,x:r,y:n,offset:o[0],length:o[1],isDir:!0}:null},$=(e,t,r,n)=>{let o=N(e,t,r,n);return o?{z:t,x:r,y:n,offset:o[0],length:o[1],isDir:!1}:null},N=(e,t,r,n)=>{let o=0,i=e.byteLength/17-1;for(;o<=i;){let a=i+o>>1,s=H(t,r,n,e,17*a);if(s>0)o=a+1;else{if(!(s<0))return[I(e,17*a+7),e.getUint32(17*a+13,!0)];i=a-1}}return null},W=(e,t)=>e.isDir&&!t.isDir?1:!e.isDir&&t.isDir?-1:e.z!==t.z?e.z-t.z:e.x!==t.x?e.x-t.x:e.y-t.y,V=(e,t)=>{let r=e.getUint8(17*t);return{z:127&r,x:B(e,17*t+1),y:B(e,17*t+4),offset:I(e,17*t+7),length:e.getUint32(17*t+13,!0),isDir:r>>7==1}},q=e=>{let t=[],r=new DataView(e);for(let e=0;e<r.byteLength/17;e++)t.push(V(r,e));return K(t)},K=e=>{e.sort(W);let t=new ArrayBuffer(17*e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++){let n=e[t],o=n.z;n.isDir&&(o|=128),r[17*t]=o,r[17*t+1]=255&n.x,r[17*t+2]=n.x>>8&255,r[17*t+3]=n.x>>16&255,r[17*t+4]=255&n.y,r[17*t+5]=n.y>>8&255,r[17*t+6]=n.y>>16&255,r[17*t+7]=255&n.offset,r[17*t+8]=255&j(n.offset,8),r[17*t+9]=255&j(n.offset,16),r[17*t+10]=255&j(n.offset,24),r[17*t+11]=255&j(n.offset,32),r[17*t+12]=255&j(n.offset,48),r[17*t+13]=255&n.length,r[17*t+14]=n.length>>8&255,r[17*t+15]=n.length>>16&255,r[17*t+16]=n.length>>24&255}return t},J=(e,t)=>{if(e.byteLength<17)return null;let r=e.byteLength/17,n=V(e,r-1);if(n.isDir){let e=n.z,r=t.z-e;return{z:e,x:Math.trunc(t.x/(1<<r)),y:Math.trunc(t.y/(1<<r))}}return null},G={getHeader:function(e){return a(this,null,function*(){let t=yield e.getBytes(0,512e3),r=new DataView(t.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),i=JSON.parse(new TextDecoder("utf-8").decode(new DataView(t.data,10,n))),a=0;"gzip"===i.compression&&(a=2);let s=0;"minzoom"in i&&(s=+i.minzoom);let l=0;"maxzoom"in i&&(l=+i.maxzoom);let u=0,c=0,d=0,f=-180,h=-85,p=180,m=85;if(i.bounds){let e=i.bounds.split(",");f=+e[0],h=+e[1],p=+e[2],m=+e[3]}if(i.center){let e=i.center.split(",");u=+e[0],c=+e[1],d=+e[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:17*o,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:a,tileType:1,minZoom:s,maxZoom:l,minLon:f,minLat:h,maxLon:p,maxLat:m,centerZoom:d,centerLon:u,centerLat:c,etag:t.etag}})},getZxy:function(e,t,r,n,o,i,s){return a(this,null,function*(){let a=yield r.getArrayBuffer(t,e.rootDirectoryOffset,e.rootDirectoryLength,e);1===e.specVersion&&(a=q(a));let l=$(new DataView(a),n,o,i);if(l){let e=(yield t.getBytes(l.offset,l.length,s)).data,r=new DataView(e);return 31===r.getUint8(0)&&139===r.getUint8(1)&&(e=O(new Uint8Array(e))),{data:e}}let u=J(new DataView(a),{z:n,x:o,y:i});if(u){let l=F(new DataView(a),u.z,u.x,u.y);if(l){let a=yield r.getArrayBuffer(t,l.offset,l.length,e);1===e.specVersion&&(a=q(a));let u=$(new DataView(a),n,o,i);if(u){let e=(yield t.getBytes(u.offset,u.length,s)).data,r=new DataView(e);return 31===r.getUint8(0)&&139===r.getUint8(1)&&(e=O(new Uint8Array(e))),{data:e}}}}})}},Q=e=>(t,r)=>{if(r instanceof AbortController)return e(t,r);let n=new AbortController;return e(t,n).then(e=>r(void 0,e.data,e.cacheControl||"",e.expires||""),e=>r(e)).catch(e=>r(e)),{cancel:()=>n.abort()}},X=class{constructor(e){this.tilev4=(e,t)=>a(this,null,function*(){if("json"===e.type){let t=e.url.substr(10),r=this.tiles.get(t);if(r||(r=new ec(t),this.tiles.set(t,r)),this.metadata)return{data:yield r.getTileJson(e.url)};let n=yield r.getHeader();return{data:{tiles:[`${e.url}/{z}/{x}/{y}`],minzoom:n.minZoom,maxzoom:n.maxZoom,bounds:[n.minLon,n.minLat,n.maxLon,n.maxLat]}}}let r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=e.url.match(r);if(!n)throw Error("Invalid PMTiles protocol URL");let o=n[1],i=this.tiles.get(o);i||(i=new ec(o),this.tiles.set(o,i));let a=n[2],s=n[3],l=n[4],u=yield i.getHeader(),c=yield null==i?void 0:i.getZxy(+a,+s,+l,t.signal);return c?{data:new Uint8Array(c.data),cacheControl:c.cacheControl,expires:c.expires}:1===u.tileType?{data:new Uint8Array}:{data:null}}),this.tile=Q(this.tilev4),this.tiles=new Map,this.metadata=(null==e?void 0:e.metadata)||!1}add(e){this.tiles.set(e.source.getKey(),e)}get(e){return this.tiles.get(e)}};function Y(e,t){return(t>>>0)*0x100000000+(e>>>0)}function ee(e){let t=e.buf,r=t[e.pos++],n=127&r;return r<128?n:(n|=(127&(r=t[e.pos++]))<<7,r<128)?n:(n|=(127&(r=t[e.pos++]))<<14,r<128)?n:(n|=(127&(r=t[e.pos++]))<<21,r<128)?n:function(e,t){let r=t.buf,n=r[t.pos++],o=(112&n)>>4;if(n<128||(o|=(127&(n=r[t.pos++]))<<3,n<128)||(o|=(127&(n=r[t.pos++]))<<10,n<128)||(o|=(127&(n=r[t.pos++]))<<17,n<128)||(o|=(127&(n=r[t.pos++]))<<24,n<128)||(o|=(1&(n=r[t.pos++]))<<31,n<128))return Y(e,o);throw Error("Expected varint not more than 10 bytes")}(n|=(15&(r=t[e.pos]))<<28,e)}var et=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,0x1555555,0x5555555,0x15555555,0x55555555,0x155555555,0x555555555,0x1555555555,0x5555555555,0x15555555555,0x55555555555,0x155555555555,0x555555555555,0x1555555555555,0x5555555555555],er=(e=>(e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.Gzip=2]="Gzip",e[e.Brotli=3]="Brotli",e[e.Zstd=4]="Zstd",e))(er||{});function en(e,t){return a(this,null,function*(){if(1===t||0===t)return e;if(2===t){if(void 0===globalThis.DecompressionStream)return O(new Uint8Array(e));let t=new Response(e).body;if(!t)throw Error("Failed to read response stream");return new Response(t.pipeThrough(new globalThis.DecompressionStream("gzip"))).arrayBuffer()}throw Error("Compression method not supported")})}var eo=(e=>(e[e.Unknown=0]="Unknown",e[e.Mvt=1]="Mvt",e[e.Png=2]="Png",e[e.Jpeg=3]="Jpeg",e[e.Webp=4]="Webp",e[e.Avif=5]="Avif",e))(eo||{}),ei=class{constructor(e,t=new Headers){this.url=e,this.customHeaders=t,this.mustReload=!1;let r="";"navigator"in globalThis&&(r=globalThis.navigator.userAgent||"");let n=r.indexOf("Windows")>-1,o=/Chrome|Chromium|Edg|OPR|Brave/.test(r);this.chromeWindowsNoCache=!1,n&&o&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(e){this.customHeaders=e}getBytes(e,t,r,n){return a(this,null,function*(){let o,i,a;i=r||(o=new AbortController).signal;let s=new Headers(this.customHeaders);s.set("range",`bytes=${e}-${e+t-1}`),this.mustReload?a="reload":this.chromeWindowsNoCache&&(a="no-store");let l=yield fetch(this.url,{signal:i,cache:a,headers:s});if(0===e&&416===l.status){let e=l.headers.get("Content-Range");if(!e||!e.startsWith("bytes */"))throw Error("Missing content-length on 416 response");let t=+e.substr(8);l=yield fetch(this.url,{signal:i,cache:"reload",headers:{range:`bytes=0-${t-1}`}})}let u=l.headers.get("Etag");if((null==u?void 0:u.startsWith("W/"))&&(u=null),416===l.status||n&&u&&u!==n)throw this.mustReload=!0,new el(`Server returned non-matching ETag ${n} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(l.status>=300)throw Error(`Bad response code: ${l.status}`);let c=l.headers.get("Content-Length");if(200===l.status&&(!c||+c>t))throw o&&o.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield l.arrayBuffer(),etag:u||void 0,cacheControl:l.headers.get("Cache-Control")||void 0,expires:l.headers.get("Expires")||void 0}})}};function ea(e,t){let r=e.getUint32(t+4,!0),n=e.getUint32(t+0,!0);return r*i(2,32)+n}function es(e){let t={buf:new Uint8Array(e),pos:0},r=ee(t),n=[],o=0;for(let e=0;e<r;e++){let e=ee(t);n.push({tileId:o+e,offset:0,length:0,runLength:1}),o+=e}for(let e=0;e<r;e++)n[e].runLength=ee(t);for(let e=0;e<r;e++)n[e].length=ee(t);for(let e=0;e<r;e++){let r=ee(t);0===r&&e>0?n[e].offset=n[e-1].offset+n[e-1].length:n[e].offset=r-1}return n}var el=class extends Error{},eu=class{constructor(e=100,t=!0,r=en){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=e,this.counter=1,this.decompress=r}getHeader(e){return a(this,null,function*(){let t=e.getKey(),r=this.cache.get(t);if(r)return r.lastUsed=this.counter++,yield r.data;let n=new Promise((t,r)=>{(function(e,t){return a(this,null,function*(){let r=yield e.getBytes(0,16384);if(19792!==new DataView(r.data).getUint16(0,!0))throw Error("Wrong magic number for PMTiles archive");if(3>function(e){let t=new DataView(e);return 2===t.getUint16(2,!0)?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):1===t.getUint16(2,!0)?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}(r.data))return[(yield G.getHeader(e))];let n=function(e,t){let r=new DataView(e),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:ea(r,8),rootDirectoryLength:ea(r,16),jsonMetadataOffset:ea(r,24),jsonMetadataLength:ea(r,32),leafDirectoryOffset:ea(r,40),leafDirectoryLength:ea(r,48),tileDataOffset:ea(r,56),tileDataLength:ea(r,64),numAddressedTiles:ea(r,72),numTileEntries:ea(r,80),numTileContents:ea(r,88),clustered:1===r.getUint8(96),internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:t}}(r.data.slice(0,127),r.etag),o=r.data.slice(n.rootDirectoryOffset,n.rootDirectoryOffset+n.rootDirectoryLength),i=`${e.getKey()}|${n.etag||""}|${n.rootDirectoryOffset}|${n.rootDirectoryLength}`,a=es((yield t(o,n.internalCompression)));return[n,[i,a.length,a]]})})(e,this.decompress).then(e=>{e[1]&&this.cache.set(e[1][0],{lastUsed:this.counter++,data:Promise.resolve(e[1][2])}),t(e[0]),this.prune()}).catch(e=>{r(e)})});return this.cache.set(t,{lastUsed:this.counter++,data:n}),n})}getDirectory(e,t,r,n){return a(this,null,function*(){let o=`${e.getKey()}|${n.etag||""}|${t}|${r}`,i=this.cache.get(o);if(i)return i.lastUsed=this.counter++,yield i.data;let s=new Promise((o,i)=>{(function(e,t,r,n,o){return a(this,null,function*(){let i=yield e.getBytes(r,n,void 0,o.etag),a=es((yield t(i.data,o.internalCompression)));if(0===a.length)throw Error("Empty directory is invalid");return a})})(e,this.decompress,t,r,n).then(e=>{o(e),this.prune()}).catch(e=>{i(e)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(e,t,r,n){return a(this,null,function*(){let o=`${e.getKey()}|${n.etag||""}|${t}|${r}`,i=this.cache.get(o);if(i)return i.lastUsed=this.counter++,yield i.data;let a=new Promise((i,a)=>{e.getBytes(t,r,void 0,n.etag).then(e=>{i(e.data),this.cache.has(o),this.prune()}).catch(e=>{a(e)})});return this.cache.set(o,{lastUsed:this.counter++,data:a}),a})}prune(){if(this.cache.size>=this.maxCacheEntries){let e,t=1/0;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(e){return a(this,null,function*(){let t=e.getKey();if(this.invalidations.get(t))return yield this.invalidations.get(t);this.cache.delete(e.getKey());let r=new Promise((r,n)=>{this.getHeader(e).then(e=>{r(),this.invalidations.delete(t)}).catch(e=>{n(e)})});this.invalidations.set(t,r)})}},ec=class{constructor(e,t,r){"string"==typeof e?this.source=new ei(e):this.source=e,r?this.decompress=r:this.decompress=en,t?this.cache=t:this.cache=new eu}getHeader(){return a(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(e,t,r,n){return a(this,null,function*(){let o=function(e,t,r){if(e>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>i(2,e)-1||r>i(2,e)-1)throw Error("tile x/y outside zoom level bounds");let n=et[e],o=i(2,e),a=0,s=0,l=0,u=[t,r],c=o/2;for(;c>0;)a=+((u[0]&c)>0),s=+((u[1]&c)>0),l+=c*c*(3*a^s),function(e,t,r,n){if(0===n){1===r&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);let n=t[0];t[0]=t[1],t[1]=n}}(c,u,a,s),c/=2;return n+l}(e,t,r),a=yield this.cache.getHeader(this.source);if(a.specVersion<3)return G.getZxy(a,this.source,this.cache,e,t,r,n);if(e<a.minZoom||e>a.maxZoom)return;let s=a.rootDirectoryOffset,l=a.rootDirectoryLength;for(let e=0;e<=3;e++){let e=function(e,t){let r=0,n=e.length-1;for(;r<=n;){let o=n+r>>1,i=t-e[o].tileId;if(i>0)r=o+1;else{if(!(i<0))return e[o];n=o-1}}return n>=0&&(0===e[n].runLength||t-e[n].tileId<e[n].runLength)?e[n]:null}((yield this.cache.getDirectory(this.source,s,l,a)),o);if(!e)return;if(e.runLength>0){let t=yield this.source.getBytes(a.tileDataOffset+e.offset,e.length,n,a.etag);return{data:yield this.decompress(t.data,a.tileCompression),cacheControl:t.cacheControl,expires:t.expires}}s=a.leafDirectoryOffset+e.offset,l=e.length}throw Error("Maximum directory depth exceeded")})}getZxy(e,t,r,n){return a(this,null,function*(){try{return yield this.getZxyAttempt(e,t,r,n)}catch(o){if(o instanceof el)return this.cache.invalidate(this.source),yield this.getZxyAttempt(e,t,r,n);throw o}})}getMetadataAttempt(){return a(this,null,function*(){let e=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength,void 0,e.etag),r=yield this.decompress(t.data,e.internalCompression);return JSON.parse(new TextDecoder("utf-8").decode(r))})}getMetadata(){return a(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(e){if(e instanceof el)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw e}})}getTileJson(e){return a(this,null,function*(){var t;let r=yield this.getHeader(),n=yield this.getMetadata(),o=1===(t=r.tileType)?".mvt":2===t?".png":3===t?".jpg":4===t?".webp":5===t?".avif":"";return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${e}/{z}/{x}/{y}${o}`],vector_layers:n.vector_layers,attribution:n.attribution,description:n.description,name:n.name,version:n.version,bounds:[r.minLon,r.minLat,r.maxLon,r.maxLat],center:[r.centerLon,r.centerLat,r.centerZoom],minzoom:r.minZoom,maxzoom:r.maxZoom}})}}},2543:()=>{},5039:(e,t)=>{var r;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=i(e,function(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return o.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)n.call(e,r)&&e[r]&&(t=i(t,r));return t}(r)))}return e}function i(e,t){return t?e?e+" "+t:e+t:e}e.exports?(o.default=o,e.exports=o):void 0!==(r=(function(){return o}).apply(t,[]))&&(e.exports=r)}()},7328:(e,t,r)=>{e.exports=r(9791)}}]);